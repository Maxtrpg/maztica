<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>龍與魔：馬茲提卡戰役介紹</title>

<!-- 字體與 GSAP -->
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;600&display=swap" rel="stylesheet">
<link href="https://fonts.cdnfonts.com/css/quatl" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

<style>
:root{
  --gold:#c9a35a;
  --jade:#0e4b3a;
  --ink:#1a1a1a;
  --paper:#f5e9c9;
}

/* 基礎 */
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:"Noto Sans TC",sans-serif;
  background:#081a14;
  color:var(--paper);
  overflow-x:hidden;
}

/* ======== 全域視差背景 ======== */
.parallax-layer{
  position:fixed;top:0;left:0;width:100%;height:100%;
  background-repeat:no-repeat;background-position:center bottom;
  background-size:cover;pointer-events:none;z-index:-7;
}
.layer-far{background-image:url('images/bg-volcano.png');z-index:-7;}
.layer-mid{background-image:url('images/bg-altar.png');z-index:-6;}
.layer-front{background-image:url('images/bg-jungle-frame.png');z-index:-5;}
.layer-fog{background-image:url('images/fog-layer.png');z-index:-4;opacity:.35;}
.layer-light{background-image:url('images/flame.png');mix-blend-mode:screen;z-index:-3;opacity:.25;}

/* ======== 頁首（翠玉背景＋金色柔光字體） ======== */
header{
  text-align:center;padding:44px 20px 32px;
  background:url('images/jade-texture.png') center/cover no-repeat;
  border-bottom:6px solid var(--gold);
  box-shadow:0 6px 16px rgba(0,0,0,.5);
}
header h1{
  font-family:'Quatl',serif;
  font-size:clamp(40px,6vw,78px);
  /* 使用三段式漸層營造更具金屬感的效果 */
  background:linear-gradient(180deg,#fff8d4,#e1c58a,#b98a38);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  /* 調整陰影讓文字金屬感更強 */
  text-shadow:0 0 8px rgba(201,163,90,.5),0 0 18px rgba(201,163,90,.3);
  animation:goldGlow 4s ease-in-out infinite;
}
@keyframes goldGlow{
  0%,100%{text-shadow:0 0 12px rgba(201,163,90,.45),0 0 22px rgba(201,163,90,.25)}
  50%    {text-shadow:0 0 16px rgba(201,163,90,.6), 0 0 28px rgba(201,163,90,.38)}
}
header p{margin-top:8px;font-size:1.1rem;color:#fffbe8}

/* ======== 主選單 ======== */
.menu{
  display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
  gap:24px;margin:24px auto 8px;max-width:1000px;justify-items:center;
}
/* 按鈕容器 */
.menu button{
  position:relative;
  width:150px;
  /* 增加按鈕本身的高度以容納更大的圖示及文字 */
  height:190px;
  background:transparent;
  border:none;
  cursor:pointer;
  display:flex;
  flex-direction:column;
  align-items:center;
  transform:scale(.85);
  opacity:0;
  transition:transform 0.25s ease, filter 0.25s ease;
}
/* 圖示容器：移除圓形與蛇形邊框，僅保留適當大小的區塊顯示圖示 */
/* 圖示容器尺寸調整至 150px × 150px */
.menu .icon{
  position:relative;
  width:150px;
  height:150px;
  border-radius:12px;
  background:transparent;
  overflow:hidden;
  transition:transform 0.4s ease;
}
/* 隱藏原蛇形邊框圖層 */
.menu .icon::before{
  content:"";
  display:none;
}
/* 標題文字 */
.menu span{
  margin-top:8px;
  font-weight:700;
  color:#fff8e0;
  text-shadow:0 1px 3px rgba(0,0,0,.55);
}
/* 按下狀態 */
.menu button.active span{
  color:#ffd56a;
}

/* 滑鼠懸停與聚焦互動效果：顯示光暈，不放大整個按鈕 */
.menu button:hover,
.menu button:focus{
  filter:drop-shadow(0 0 6px rgba(201,163,90,.7));
}

/* 懸停時圖示緩慢放大，從 150px 放大至約 200px (scale ≈1.33) */
.menu button:hover .icon,
.menu button:focus .icon{
  transform:scale(1.33);
}

    /*
     * ======== 自訂按鈕圖示 ========
     * 透過 ::after 偽元素在每個主選單按鈕的 icon 上加入圖示，
     * 圖檔存放於 images 目錄，並針對不同的 data-section 指定對應圖片。
     */
    .menu button .icon::after{
      content:"";
      position:absolute;
      /* 留出邊緣，使圖示不緊貼邊緣 */
      inset:10%;
      background-size:contain;
      background-position:center;
      background-repeat:no-repeat;
      pointer-events:none;
      z-index:1;
    }
    .menu button[data-section="dragonbane"] .icon::after{background-image:url('images/icon-dragonbane.png');}
    .menu button[data-section="maztica"]   .icon::after{background-image:url('images/icon-maztica.png');}
    .menu button[data-section="play"]      .icon::after{background-image:url('images/icon-play.png');}
    .menu button[data-section="guild"]     .icon::after{background-image:url('images/icon-guild.png');}
    .menu button[data-section="scenario"]  .icon::after{background-image:url('images/icon-scenario.png');}

/* 分隔線 */
.divider{
  width:100%;
  /* 將分隔線高度加倍，使其視覺大小為原本的 200% */
  height:80px;
  margin:18px 0 0;
  /* 使用 repeat-x 重複圖案，讓水平線以原尺寸橫跨整個寬度 */
  background:url('images/aztec-divider.png') repeat-x;
  /* 將背景圖樣拉伸至兩倍高度，搭配 repeat-x 形成連續圖案 */
  background-size:auto 200%;
  opacity:.9;
}

/* ======== 章節舞台 ======== */
.stage{
  max-width:1200px;margin:28px auto;padding:28px;
  background:rgba(0,0,0,.55);border:6px double var(--gold);border-radius:20px;overflow:hidden
}

/* ======== 通用圖文區 ======== */
.preview{display:grid;grid-template-columns:1fr 1fr;gap:28px;align-items:center}
.preview img{width:100%;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.4)}
@media(max-width:900px){.preview{grid-template-columns:1fr}}
.copy h2{font-family:'Quatl',serif;color:#f7eab7;margin:0 0 10px}
.copy p{line-height:1.75;color:#f1e8d6;opacity:0;transform:translateY(16px)}
.copy p.show{opacity:1;transform:translateY(0);transition:opacity 1s ease,transform 1s ease}

/* 幻燈片 */
.slideshow{position:relative;width:100%;min-height:260px}
.slideshow img{position:absolute;inset:0;width:100%;border-radius:12px;opacity:0;transition:opacity 1s ease}
.slideshow img.active{opacity:1;position:relative}

/* ======== 馬茲提卡：主要區域互動 ======== */
.region-section{background:rgba(0,0,0,.25);border-radius:16px;border:4px double var(--gold);padding:18px;margin-top:18px}
.region-buttons{display:flex;justify-content:center;gap:14px;flex-wrap:wrap}
/* 調整區域按鈕為方形互動按鈕，與主選單樣式一致 */
.region-buttons button{
  /* 調整為長方形按鈕 130×60 */
  width:130px;
  height:60px;
  border-radius:8px;
  border:2px solid var(--gold);
  background:rgba(255,255,255,.08);
  font-weight:700;
  color:var(--paper);
  cursor:pointer;
  transition:transform .25s, background .25s, color .25s;
}
.region-buttons button:hover{
  transform:scale(1.06);
  background:var(--gold);
  color:#1a1a1a;
}
.region-preview{display:grid;grid-template-columns:1fr 1fr;gap:18px;align-items:center;margin-top:12px}
.region-preview img{width:100%;border-radius:12px;opacity:0;transition:opacity 1s ease}
.region-preview img.show{opacity:1}
.region-preview .desc p{opacity:0;transform:translateY(20px);transition:opacity 1s ease,transform 1s ease}
.region-preview .desc p.show{opacity:1;transform:translateY(0)}
@media(max-width:900px){.region-preview{grid-template-columns:1fr}}

/* ======== 可以玩到什麼：特色／分頁 ======== */
.features{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px;margin-bottom:18px}
.feature-card{background:rgba(255,255,255,.08);border:2px solid var(--gold);border-radius:10px;padding:12px;color:#f5e9c9;text-align:center;box-shadow:0 3px 8px rgba(0,0,0,.3);opacity:0;transform:translateY(15px);transition:opacity .8s ease, transform .8s ease}
.feature-card.show{opacity:1;transform:translateY(0)}
.play-tabs{display:flex;justify-content:center;gap:18px;margin:8px 0 16px}
.play-tabs button{padding:10px 18px;border-radius:8px;border:2px solid var(--gold);background:rgba(255,255,255,.1);color:#f5e9c9;font-weight:600;cursor:pointer;transition:background .25s}
.play-tabs button:hover{background:rgba(201,163,90,.28)}
.play-tabs button.active{background:var(--gold);color:#1a1a1a}
.sub-buttons{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:12px;margin-bottom:16px}
.sub-buttons button{padding:8px 10px;border-radius:8px;border:2px solid var(--gold);background:rgba(255,255,255,.1);color:#f5e9c9;font-weight:700;cursor:pointer}
.sub-buttons button.active,.sub-buttons button:hover{background:var(--gold);color:#1a1a1a}
.sub-preview{display:grid;grid-template-columns:1fr 1fr;gap:18px;align-items:center}
.sub-preview img{width:100%;border-radius:12px;opacity:0;transition:opacity .8s ease}
.sub-preview img.show{opacity:1}
.sub-preview .desc p{opacity:0;transform:translateY(20px);transition:opacity .8s ease, transform .8s ease}
.sub-preview .desc p.show{opacity:1;transform:translateY(0)}
@media(max-width:900px){.sub-preview{grid-template-columns:1fr}}

/* ======== 公會：標籤雲 ======== */
.tag-cloud{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin:10px 0}
.tag-cloud button{padding:8px 12px;border-radius:18px;border:2px solid var(--gold);background:rgba(255,255,255,.08);color:#f5e9c9;font-weight:700;cursor:pointer}
.tag-cloud button.active,.tag-cloud button:hover{background:var(--gold);color:#1a1a1a}
.guild-card{display:grid;grid-template-columns:1fr 1fr;gap:18px;align-items:center;margin-top:12px}
.guild-card img{width:100%;border-radius:12px}
@media(max-width:900px){.guild-card{grid-template-columns:1fr}}

/* ======== 公會：冒險者標籤與雙面公會證 ======== */
/* 成員按鈕列，電腦版每列五個，手機版自動換行 */
.member-buttons{
  display:grid;
  grid-template-columns:repeat(5,1fr);
  gap:10px;
  margin-bottom:16px;
  justify-items:center;
}
@media(max-width:900px){
  .member-buttons{
    grid-template-columns:repeat(auto-fit,minmax(120px,1fr));
  }
}
.member-buttons button{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:flex-start;
  width:120px;
  height:140px;
  padding:10px;
  border:2px solid var(--gold);
  border-radius:10px;
  background:rgba(255,255,255,.08);
  color:var(--paper);
  font-weight:700;
  cursor:pointer;
  transition:background .25s,color .25s,transform .25s;
}
.member-buttons button.active,
.member-buttons button:hover{
  background:var(--gold);
  color:#1a1a1a;
}
.member-buttons .avatar{
  width:100%;
  height:100px;
  margin-bottom:6px;
  background-size:cover;
  background-position:center;
  border-radius:6px;
}

/* 公會證卡區：左右兩側顯示正背面 */
.guild-card-area{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
  margin-top:12px;
}
.guild-card-area .card-side{
  position:relative;
  width:100%;
}
.guild-card-area .card-side img{
  width:100%;
  display:block;
  border-radius:12px;
}
/* 文字覆蓋欄位通用樣式 */
/*
 * 文字覆蓋欄位通用樣式
 * 使用 CSS 變數控制每個欄位的位置與大小，方便日後依需求調整。
 * 說明：
 *   --name-bottom, --name-left, --name-right, --name-font-size：控制正面姓名欄位的位置與字體大小
 *   --race-top, --class-top, --desc-top：控制背面三個紅框欄位 (族裔/職業/描述) 的垂直位置
 *   --race-font-size, --class-font-size, --desc-font-size：控制三個欄位字體大小
 *   --rank-top, --rank-left, --rank-width, --rank-font-size：控制背面等級字母欄位的位置與大小
 */
:root{
  --name-bottom: 18%;
  --name-left: 8%;
  --name-right: 8%;
  --name-font-size: 1.4rem;
  --race-top: 41%;
  --class-top: 55%;
  --desc-top: 67%;
  --race-font-size: 1.2rem;
  --class-font-size: 0.9rem;
  --desc-font-size: 0.9rem;
  --rank-top: 21%;
  --rank-left: 35%;
  --rank-width: 30%;
  --rank-font-size: 3.5rem;
}

.guild-card-area .name-field,
.guild-card-area .rank-field,
.guild-card-area .back-field1,
.guild-card-area .back-field2,
.guild-card-area .back-field3{
  position:absolute;
  color:var(--gold);
  font-weight:700;
  text-align:center;
  text-shadow:0 0 4px rgba(0,0,0,.7);
  line-height:1.2;
  padding:2px 4px;
  box-sizing:border-box;
}
/* 正面姓名位置：置於底部綠框中，可透過變數調整 */
.guild-card-area .front .name-field{
  bottom: var(--name-bottom);
  left: var(--name-left);
  right: var(--name-right);
  font-size: var(--name-font-size);
  color: var(--paper);
}
/* 背面等級字母位置：上方小金框，可透過變數調整 */
.guild-card-area .back .rank-field{
  top: var(--rank-top);
  left: var(--rank-left);
  width: var(--rank-width);
  font-size: var(--rank-font-size);
}
/* 背面三行文字對應三個紅框，可透過變數調整 */
.guild-card-area .back .back-field1{
  top: var(--race-top);
  left:12%;
  right:12%;
  font-size: var(--race-font-size);
}
.guild-card-area .back .back-field2{
  top: var(--class-top);
  left:12%;
  right:12%;
  font-size: var(--class-font-size);
}
.guild-card-area .back .back-field3{
  top: var(--desc-top);
  left:12%;
  right:12%;
  font-size: var(--desc-font-size);
}
@media(max-width:900px){
  .guild-card-area{grid-template-columns:1fr;}
}

/* 龍與魔章節官方連結按鈕 */
.external-link-btn{
  display:inline-block;
  margin-top:16px;
  padding:10px 18px;
  border:2px solid var(--gold);
  border-radius:8px;
  background:rgba(255,255,255,.1);
  color:var(--paper);
  font-weight:700;
  text-decoration:none;
  transition:background .25s,color .25s;
}
.external-link-btn:hover{
  background:var(--gold);
  color:#1a1a1a;
}

/* BGM 控制器 */
.bgm-control{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  margin-top:12px;
}
.bgm-control button{
  padding:6px 10px;
  border:2px solid var(--gold);
  border-radius:6px;
  background:rgba(255,255,255,.1);
  color:var(--paper);
  cursor:pointer;
  transition:background .25s,color .25s;
}
.bgm-control button:hover{
  background:var(--gold);
  color:#1a1a1a;
}
.bgm-control input[type=range]{
  width:120px;
}

/* 備註區塊：放置冒險者備註說明，顯示於公會證下方 */
#guild-note{
  margin-top:12px;
  color:var(--paper);
  line-height:1.5;
}
</style>
</head>
<body>

<!-- 全域視差背景 -->
<div class="parallax-layer layer-far"></div>
<div class="parallax-layer layer-mid"></div>
<div class="parallax-layer layer-front"></div>
<div class="parallax-layer layer-fog"></div>
<div class="parallax-layer layer-light"></div>

<header>
  <h1>龍與魔：馬茲提卡戰役介紹</h1>
  <p>阿茲特克中美洲世界觀－充滿叢林和神祕的大陸</p>
</header>

<!-- 主選單 -->
<nav class="menu">
  <button class="active" data-section="dragonbane"><div class="icon"></div><span>「龍與魔」<br>是怎樣的系統</span></button>
  <button data-section="maztica"><div class="icon"></div><span>「馬茲提卡」<br>是什麼地方</span></button>
  <button data-section="play"><div class="icon"></div><span>你可以<br>玩到什麼</span></button>
  <button data-section="guild"><div class="icon"></div><span>佩澤拉克<br>冒險者公會</span></button>
  <button data-section="scenario"><div class="icon"></div><span>目前可約<br>劇本</span></button>
</nav>

<!-- BGM 音樂控制器 -->
<audio id="bgm" src="audio/Aztec.m4a" loop></audio>
<div class="bgm-control">
  <button id="bgm-toggle">▶</button>
  <input id="bgm-volume" type="range" min="0" max="1" step="0.05" value="0.5">
 
</div>

<div class="divider"></div>

<!-- 章節舞台 -->
<section class="stage" id="stage"></section>

<script>
/* ===== 視差設定 ===== */
gsap.registerPlugin(ScrollTrigger);
document.querySelectorAll('.parallax-layer').forEach(layer=>{
  let depth=0;
  if(layer.classList.contains('layer-far'))   depth=0.2;
  if(layer.classList.contains('layer-mid'))   depth=0.4;
  if(layer.classList.contains('layer-front')) depth=0.6;
  if(layer.classList.contains('layer-fog'))   depth=0.8;
  if(layer.classList.contains('layer-light')) depth=0.9;
  gsap.to(layer,{
    y:()=>window.innerHeight*depth,
    ease:'none',
    scrollTrigger:{trigger:document.body,start:'top top',end:'bottom bottom',scrub:true}
  });
});

/* 主選單進場 */
gsap.to('.menu button',{scale:1,opacity:1,stagger:0.1,duration:1.05,ease:'back.out(1.7)',delay:0.4});

/* 段落交錯淡入 */
function applyStagger(container){
  const ps = container.querySelectorAll('.copy p');
  ps.forEach((p,i)=>{
    p.classList.remove('show');
    p.style.transitionDelay = `${i*0.5}s`;
    void p.offsetWidth;
    p.classList.add('show');
  });
  container.querySelectorAll('.feature-card').forEach((c,i)=>setTimeout(()=>c.classList.add('show'), i*120));
}

/* 幻燈片 */
let slideTimer=null;
function setupSlideshow(root){
  if(slideTimer) clearInterval(slideTimer);
  const slides = root.querySelectorAll('#slideshow img'); if(!slides.length) return;
  let idx=0; slideTimer=setInterval(()=>{slides[idx].classList.remove('active'); idx=(idx+1)%slides.length; slides[idx].classList.add('active');},4000);
}

/* ===== 章節模板 ===== */
const Templates={
  dragonbane:()=>`
    <div class="preview">
      <div class="slideshow" id="slideshow">
        <img src="images/dragonbane-cover1.png" class="active" alt="龍與魔1">
        <img src="images/dragonbane-cover2.png" alt="龍與魔2">
        <img src="images/dragonbane-cover3.png" alt="龍與魔3">
        <img src="images/dragonbane-cover4.png" alt="龍與魔4">
        <img src="images/dragonbane-cover5.png" alt="龍與魔5">
      </div>
      <div class="copy">
        <h2>龍與魔</h2>
        <p>Dragonbane是一款充滿魔法、神秘和冒險的經典奇幻桌上角色扮演遊戲。它的設計從一開始就旨在促進快速而激烈的遊戲，只需很少的準備時間和輕鬆的冒險。</p><br>
        <p>這是一款充滿歡樂的遊戲，同時仍為冒險者們提供殘酷的挑戰。我們將這種遊戲風格稱為「歡樂與混亂的角色扮演」——非常適合長時間戰役，但也非常適合 One Shot 遊玩。</p><br>
        <p>Dragonbane是《Drakar och Demoner》的翻譯版本，是斯堪地納維亞地區第一款也是最大的桌上角色扮演遊戲，最初於 1982 年推出。由 Free League Publishing 出版並享譽全球。</p><br>
        <p>在麥斯的團務中，並非採用官方世界觀，而是採用馬茲提卡作為戰役舞台。</p>
        <!-- 前往官方網站按鈕 -->
        <a href="https://freeleaguepublishing.com/en/games/dragonbane/" class="external-link-btn" target="_blank" rel="noopener">前往官方網站</a>
      </div>
    </div>
  `,
  maztica:()=>`
    <div class="preview">
      <img src="images/maztica-map.png" alt="馬茲提卡地圖">
      <div class="copy">
        <h2>馬茲提卡大陸</h2>
        <p>馬茲提卡為原 DND 世界中的一塊中美洲風格大陸，取材自阿茲特克文明，是一片充滿叢林和神祕的大陸。</p><br>
        <p>經過個人調整並加入許多房規後現為戰役舞台，整體風格就是濃濃的阿茲特克中美洲味。</p><br>
        <p>馬茲提卡是一個完整的大陸供玩家探索。有數百個地點、有待解開的謎團和值得數年的冒險。</p><br>
        <p>戰役中開始會先圍繞在較安全的佩澤拉克附近，隨著冒險推進，將會逐步前往更加偏遠和危險的地方。</p>
      </div>
    </div>
    <div class="region-section">
      <h3 style="text-align:center;margin:0 0 10px;color:#f7eab7">目前主要區域</h3>
      <div class="region-buttons">
        <button data-region="kutaka">庫塔卡</button>
        <button data-region="payit">帕伊特</button>
        <button data-region="pezelac">佩澤拉克</button>
        <button data-region="nexal">內克薩爾</button>
      </div>
      <div class="region-preview">
        <img id="region-img" class="show" src="images/region-default.png" alt="主要區域">
        <div class="desc" id="region-desc"><p class="show">請選擇上方的區域以查看詳細介紹。</p></div>
      </div>
    </div>
  `,
  play:()=>`
    <div class="features" id="features">
      <div class="feature-card"><br>體驗龍與魔這個系統的<br>魅力與特色</div>
      <div class="feature-card"><br>享受中美洲<br>阿茲特克文化氛圍</div>
      <div class="feature-card"><br>起始有八種族裔<br>十種職業範型可供選擇</div>
      <div class="feature-card">職業範型不代表生涯方向<br>只是你的冒險起始包<br>在冒險過程中可以<br>自由培養你的角色</div>
      <div class="feature-card">沒有等級概念<br>每次團務結束進行技能成長<br>隨著參與的團務愈多<br>你的角色就會愈強</div>
      <div class="feature-card">冒險者的生活<br>充滿未知與危險<br>日常的生存也是種考驗<br>旅行的過程不容馬虎</div>
      <div class="feature-card"><br>戰鬥刺激且瞬息萬變<br>每個行動關乎你的生死</div>
      <div class="feature-card">和玩家共構整個世界<br>你們的行動和選擇<br>不僅關乎當下<br>甚至如蝴蝶效應般影響未來</div>
    </div>
    <div class="play-tabs">
      <button class="active" data-tab="race">族裔</button>
      <button data-tab="class">職業範型</button>
    </div>
    <div id="play-tab-content">${renderSubTab('race')}</div>
  `,
  guild:()=>`
    <div class="preview">
      <img src="images/guild-emblem.png" alt="冒險者公會徽章">
      <div class="copy">
        <h2>冒險者公會</h2>
        <p>原本的馬茲提卡是不存在「冒險者」這種概念的工作職業，是外大陸所帶來的影響，起因為「黃金軍團入侵」事件。</p><br>
        <p>如今相對和平的時代，越來越多的冒險者們離開家園，選擇與其他族裔交流，探索這塊充滿機遇和危險的大陸。</p><br>
        <p>目前唯一的冒險者公會建立在佩澤拉克。傳聞公會會長也是一位冒險者，雖尚不清楚創立目的，但公會整合資源、提供支援。</p>
      </div>
    </div>
    <div class="region-section">
      <h3 style="text-align:center;margin:0 0 10px;color:#f7eab7">已於公會登記／可查詢冒險者</h3>
      <!-- 成員按鈕將由 JS 產生 -->
      <div class="member-buttons" id="member-buttons"></div>
      <!-- 公會證正反面展示區 -->
      <div class="guild-card-area" id="guild-card-area">
        <div class="card-side front">
          <img src="images/guildcards/front.png" alt="公會證正面">
          <div class="name-field"></div>
        </div>
        <div class="card-side back">
          <img src="images/guildcards/back.png" alt="公會證背面">
          <div class="rank-field"></div>
          <div class="back-field1"></div>
          <div class="back-field2"></div>
          <div class="back-field3"></div>
        </div>
      </div>
      <!-- 備註資訊：僅顯示會員備註，不重複顯示卡片上的資料 -->
      <div class="copy" id="guild-note"></div>
    </div>
  `,
  scenario:()=>`
    <div class="copy">
      <h2>揪團注意事項</h2>
      <p class="show">請自行找好至少 3–4 名玩家再找我約時間；平日下午也可約。</p>
      <p class="show">團務費：<br>－異光：450 元／人／結團<br>－其他劇本：350 元／人／次</p>
    </div>
    <div class="play-tabs" id="scn-tabs">
      <button class="active" data-scncat="prologue">前導／新手任務</button>
      <button data-scncat="main">主線任務</button>
      <button data-scncat="side">支線任務</button>
    </div>
    <div class="region-section">
      <div class="tag-cloud" id="scn-tags"></div>
      <div class="sub-preview" id="scn-detail">
        <img src="images/scenarios/default.jpg" class="show" alt="劇本圖">
        <div class="desc"><p class="show">請選擇上方標籤以查看劇本介紹。</p></div>
      </div>
    </div>
  `
};

/* ===== 子分頁資料 ===== */
const raceList=[
  {key:'人類',img:'images/race/Humans.png',text:`在馬茲提卡大陸上，人類是最廣泛分布的族裔，佔了總人口的六至七成。他們的特徵並非強壯的身軀或長壽的血統，而是無與倫比的適應力與堅韌。在荒蕪的高原、潮濕的沼澤、叢林深處或沿海城邦，都能找到人類的身影。他們能與野蠻的野獸搏鬥，也能在嚴苛的環境下建立農田與城邦，靠智慧與團結延續文明。<br><br>眾多部落和城邦對於人類的起源各有說法，但最廣為流傳的神話源於偉大的太陽神庫庫爾。傳說中，諸神嘗試以泥土、木頭和黃金塑造生命，卻無一能滿足祂們的期望。唯有庫庫爾願以犧牲為代價，揮舞馬夸維爾特割下自己的手指，墜落於大地後化為會行走、能言語的人類。人類因此背負著崇敬與獻祭的使命，被視為最能與神祇相連的族群。<br><br>然而，人類並非單一面貌。北方的狗民、叢林裡的綠民、科技城邦帕伊特和戰士國度庫塔卡等，不同地方的人種展現出不同的膚色、服飾與文化。對冒險者而言，人類既可能是最可靠的同伴，也可能是最危險的敵人。`},
  {key:'半身人',img:'images/race/Halfling.png',text:`半身人是一支既神秘又難以忽視的族群。傳說他們源於不朽紀元的女神基爾茲，是祂在大地與叢林間留下的孩子。他們個頭嬌小，卻極為靈活，與茂密的叢林環境融為一體，天生擅長隱蔽與迴避，使他們能在巨獸橫行的荒野中安然生存。<br><br>許多半身人生活於叢林深處的部落中，依舊遵循著古老的習俗。他們精於使用植物與毒藥，最著名的是「庫拉里」，這種能迅速麻痺獵物的毒素常被塗抹在戰弓與吹箭的箭刃上。憑藉這些技巧，他們能夠在以弱勝強的狩獵與戰鬥中立於不敗。這些部落對外來者多抱持戒心，甚至敵意，將叢林視為他們的神聖領土。<br><br>然而，仍有不少半身人選擇與人類社會融合，在村鎮或城邦中建立新的生活。他們常被視為靈巧的獵人、可靠的嚮導，或是熟稔草藥與工藝的匠人。無論身處叢林或城邦，半身人以樂觀與堅韌聞名，他們在看似脆弱的外表下，蘊藏著無可忽視的力量與智慧。`},
  {key:'精靈',img:'images/race/Elf.png',text:`在馬茲提卡的傳說與神話中，精靈是一支古老而神秘的族裔。他們擁有修長的耳朵與異於常人的膚色：有些如泥土般溫潤，有些粗糙似樹皮，還有些閃耀著金屬光澤。這些特徵使許多人推測，精靈或許是諸神在創造人類前的「試驗之作」，那些不完整卻帶有神性印記的存在。<br><br>精靈自稱已在大陸上隱居數千年，居住於人跡罕至的深林、山谷與荒原之中。他們的社群往往難以被外界發現，卻在自然環境中留下了獨特的印記：藤蔓纏繞的石殿、月光下閃耀的祭壇、以及傳唱古老語言的歌聲。直到近代，隨著諸神傳聞再度歸來，他們才逐漸與其他種族接觸，帶著一種既疏離又令人難以抗拒的優雅。<br><br>在一般人眼中，精靈既可能是知識與古老智慧的傳遞者，也可能是隱藏目的的觀察者。他們冷靜而優雅，行事深思熟慮，與自然世界有著難以言喻的聯繫。究竟精靈的真正使命是守護大陸，還是為某個古老的契約服務，沒有人能確定。`},
  {key:'矮人',img:'images/race/Dwarf.png',text:`在馬茲提卡，矮人並沒有建立龐大的王國，但他們的足跡遍布大陸最嚴酷的沙漠地帶。最初，他們出現在伊茲卡拉沙漠的邊陲，憑藉堅毅與適應力迅速融入炙熱荒原的生活，並逐漸散布至所有沙漠地區。如今，人口最集中的地方是泰茲卡之家，當地的矮人社群以「酋長」為領袖，而在荒蕪的峭壁群落中，他們的領袖則被尊稱為「峭壁看守者」。<br><br>矮人社群規模不大，往往僅有數十至數百人，隱居於洞穴、峭壁或地下廳堂中。他們以石工與冶煉聞名，能從貧瘠的荒原中提煉出珍貴的礦石與金屬，並打造堅固的武器與防具。這些技藝使他們在戰爭或貿易中都佔有一席之地。<br><br>然而，沙漠矮人性格謹慎而冷漠。他們在遇到外來者前，往往會暗中觀察許久，以判斷對方是否值得信任。與狗民的衝突最為常見，雙方彼此敵視，卻也懂得保持距離，避免引發全面戰爭。矮人偶爾也會與地下的蝎人相爭，但更多時候，他們選擇守護自己的峭壁與部族，遠離塵囂。<br><br>對其他族裔而言，矮人或許是冷眼旁觀的隱士，但一旦建立信任，他們將展現出最堅固的盟誼與最可靠的鋼鐵之刃。`},
  {key:'鷹人',img:'images/race/Quetzaldaun.png',text:`在馬茲提卡的險峻高山與絕壁之巔，棲息著一支古老而罕為人知的族裔——鷹人，當地人稱為「奎查達恩（Quetzaldaun）」。他們擁有覆滿羽毛的身軀、鋒銳的爪與能張展的雙翼，看似與傳說中的阿拉科克拉相似，但卻自稱是更為尊貴的後裔。據說在遠古時代，太陽與風暴之神夸爾特曾降下恩賜，使他們由脆弱的鳥類化為今日強健而威嚴的姿態。<br><br>鷹人一向隱居避世，聚落多在高處岩壁與天險間建立巢居，傳承以風、天空與太陽為核心的文化。他們的歌聲被視為向神祇獻祭的祈禱，羽毛裝飾則象徵榮耀與地位。然而，近年大陸的動盪與戰亂迫使許多鷹人失去了棲所，不得不離開家鄉的懸崖，與其他族裔接觸。<br><br>雖然高傲且警惕，鷹人逐漸理解人類能成為守護其文化與信仰的盟友。對其他族裔而言，鷹人或許是神秘的同伴，他們能在天空中偵察敵情，或以俯衝之勢在戰場上展現凌厲的威勢。但若未獲得他們的信任，鷹人將依舊如高空的烈陽般，遙不可及。`},
  {key:'蜥蜴人',img:'images/race/LizardPeople.png',text:`在馬茲提卡的沼澤與水域地帶，是蜥蜴人的地盤。關於蜥蜴人的起源沒人知曉，但蜥蜴人普遍信奉著火巨人泰茲卡，並堅信他們是受到了火巨人的祝福而獲得強大的力量。儘管有學者懷疑和噬心者札爾特克的獸術有關，但蜥蜴人堅決否認這種說法。<br><br>沼澤嚴苛的環境塑造了蜥蜴人冷酷而堅毅的性格。他們是天生的掠食者，擅長以耐心與潛伏等待獵物，屏息潛水的天賦更讓他們在水下出沒如影。他們通常避開容易受潮損壞的皮革與金屬，轉而選擇骨牙、石片、甚至火山玻璃打造武器與護具，這些裝備雖粗獷卻極為實用。蜥蜴人以部落為單位活動，能在危險的沼澤裡自給自足，鮮少依賴外界。<br><br>然而，大約一世紀前，許多蜥蜴人薩滿同時夢見了神祇的徵兆，聲稱水面之外的土地將與他們的命運交織。自此，部分蜥蜴人開始走出濕地，與人類城邦進行貿易與交流。對其他族裔而言，蜥蜴人既可能是冷酷的沼澤獵手，也可能是堅定的盟友——端看你是否贏得他們的尊重。`},
  {key:'豹人',img:'images/race/PantherPeople.png',text:`在馬茲提卡幽深的叢林裡，豹人是最令人畏懼也最神秘的族裔之一。他們長久以來守護著高聳的樹冠領地，過著以狩獵為榮的生活。豹人身形敏捷、肌肉結實，眼神如同叢林中最銳利的掠食者，行動無聲卻致命。對他們而言，狩獵不僅是生存，更是一門藝術與信仰。<br><br>在過去的世代，豹人薩滿以智慧勸告族人遠離其他文明，保持獨立與純粹的生活方式。然而，當人類逐漸探索並侵入叢林時，這份古老的規訓開始動搖。部分豹人對人類的信仰與城邦文化心生憎惡，另一些則選擇改變，放棄野性而追求「文明」，甚至與外族進行交易與合作。他們以卓越的獵術和珍稀毛皮進行交換，偶爾成為外族的盟友。<br><br>對其他族裔而言，與豹人的相遇可能意味著交易、試煉，或是一場生死搏殺。`},
  {key:'蛙人',img:'images/race/FrogPeople.png',text:`在馬茲提卡的水域地帶，除了居住著蜥蜴人之外，還有一群神秘的蛙人。關於蛙人的起源眾說紛紜，但學者們普遍認為是薩滿儀式出錯的意外結果。<br><br>天性善良的蛙人是蜥蜴人食物之一，兩族之間時常有碰撞與衝突。因此許多蛙人部落為求庇護選擇和人類合作，現在在許多城市裡也能見到蛙人的蹤跡。但在蜥蜴人選擇出來和文明社會交流之後，現在兩族的衝突明顯減少，能較和平的共處。<br><br>蛙人對於寶石有著強烈的愛好，這點在商業生意上得到更好的發揮。他們總是能夠找到珍貴華美的寶石，許多貴族往往願意出高價向其購買。憑藉天生的優勢，有貿易的地方蛙人總能佔有一席之地。`}
];
const classList=[
  {key:'工匠',img:'images/profession/Artisan.png',text:`工匠是一群將心血與歲月投注於技藝的人。憑藉雙手與知識，將自然界的材料化為堅固的器具、精美的飾品與實用的武器。工匠們懂得如何挑選最堅韌的黑曜石來製作鋒利的刃片，如何運用玉石、羽毛與金屬，打造出兼具美觀與象徵意義的裝飾品。他們的作品不僅是物質上的創造，更承載了部族與城邦的榮耀。<br><br>在戰場上，工匠是不可或缺的後盾。他們鍛造的長矛、斧刃與盾牌，能決定戰士的生死；在和平時期，他們則製作農具、織機與日常用具，維繫著社會的運轉。工匠熟悉不同工藝領域，有的專精於金屬與石材的打磨，有的善於紡織、繪飾與建築。他們的地位雖然低調，但卻深受尊敬，因為他們的雙手塑造了文明的基石。<br><br>選擇工匠範型，代表你將深入理解細緻的工藝與勞動的價值。你可能是來自繁華城邦的工坊學徒，也可能是隱居村落的木匠後裔。透過不斷精進的技術，你能在冒險中提供團隊可靠的裝備、修繕支援，甚至用創造力解決棘手的難題。這條道路，並非追求華麗的力量，而是透過汗水與技巧，在每一次的敲擊與雕琢之中，留下屬於自己的印記。`},
  {key:'獵人',img:'images/profession/Hunter.png',text:`在馬茲提卡廣袤的叢林與山谷之間，獵人是自然的探索者與守望者。他們熟悉林木的氣息、動物的習性，以及隱藏於濃密葉影中的危機。獵人不僅是弓矢與陷阱的能手，更是觀察的專家：一片斷裂的枝葉、一行輕微的足跡，對他們來說就是指引方向的路標。<br><br>在部族與城邦的生活裡，獵人負責提供肉食與獸皮，他們懂得如何在不驚擾自然的情況下獲取資源。當危險來臨時，他們的技能更能轉化為守護的力量──無論是設置陷阱對抗入侵者，還是憑藉敏銳的眼力，預先發現潛伏的猛獸。<br><br>馬茲提卡的叢林充滿濕熱與未知，毒蛇、猛禽與沼澤中的掠食者無所不在。獵人卻能在其中自在行走，靠著熟悉的道路與草藥知識保持安全。他們能為同伴找到乾淨的水源，辨別可食與有毒的果實，並在危險時刻帶領隊伍穿越隱蔽小徑。<br><br>選擇獵人範型，代表你將把自然當作盟友。你可能是森林部落中磨練出的巡林者，也可能是獨自徘徊於荒野的遊俠。你的價值在於行動的敏捷、目光的銳利，以及對叢林無與倫比的理解。無論是在狩獵還是冒險中，獵人始終是開路的先鋒，也是荒野裡最可靠的同伴。`},
  {key:'詩人',img:'images/profession/Bard.png',text:`在馬茲提卡的文明中，詩人並非單純的吟遊者，而是知識的守護者與文化的傳承者。他們被稱為「花與歌之人」，透過詩句、音樂與舞蹈來頌揚神祇、記錄歷史、傳遞智慧。詩人的話語與旋律能凝聚族群的信念，使城邦在動盪與榮耀中維繫共同的記憶。<br><br>詩人在社會中享有崇高地位，他們出席祭典、戰前儀式與領主的宮廷，擔任見證與講述的角色。人們相信，詩歌不僅能陶冶心靈，更能讓勇士記住自己的榮耀與責任。許多首領與戰士渴望詩人的讚頌，因為那代表他們的名字將在世代的歌聲裡長存。<br><br>專精於不同領域的詩人各有價值：有的偏重史詩吟誦，能將過往戰事與族群傳說娓娓道來；有的擅長歌舞與樂器，帶來凝聚情感的力量；也有詩人專注於隱喻與箴言，他們的話語像謎語般啟迪聽眾。這些專精不僅是藝術的差異，更影響他們在冒險中的作用——一位史詩詩人能鼓舞士氣，一位歌舞詩人能拉近陌生群體的距離，而一位箴言詩人則可能以機智言詞化解危機。<br><br>選擇詩人範型，代表你將承擔一份特殊的責任：不只是觀察者，更是文化的記錄者與推動者。你的聲音，能將冒險的片段編織成世代傳唱的傳奇。`},
  {key:'戰士',img:'images/profession/Warrior.png',text:`在馬茲提卡大陸，戰士是社會與城邦的支柱。他們不僅是戰場上的鬥士，更是部族榮耀的象徵。自少年起，戰士便接受嚴格訓練，學習如何在叢林與平原上求生，如何揮舞各式各樣的武器。對馬茲提卡人而言，武勇與榮譽往往決定一個人的地位，而戰士正是這份價值的化身。<br><br>戰士熟悉多種武器：黑曜石劍(馬夸維爾特) 能劈裂骨肉；長柄木矛與投槍器在近戰與遠距中皆具威脅；羽飾圓盾不僅保護身軀，也象徵身分與成就。部分戰士專注於重裝與近身搏鬥，正面突破敵陣；另一些則強調敏捷與靈巧，習慣於叢林中埋伏、突擊。無論流派不同，戰士們都以紀律與實戰磨練成就自我。<br><br>在城邦與部族中，戰士的地位舉足輕重。他們是保護領地與人民的屏障，也是祭典與儀式上不可或缺的角色。俘虜敵人、奮戰至死、贏得榮譽，這些行為能使戰士的名字傳頌於世，甚至獲得神祇的垂青。<br><br>選擇戰士範型，代表你承擔了最直接卻最重要的職責：以武藝與勇氣守護同伴與信念。無論是舉盾在前，還是持矛開道，戰士都是隊伍的核心力量，讓冒險能在危險的土地上持續前行。`},
  {key:'騎士',img:'images/profession/Knight.png',text:`在馬茲提卡的城邦與部族社會中，騎士象徵著最高的榮耀與最沉重的責任。他們不僅是訓練有素的精銳戰士，更是信仰與軍事的代表。成為騎士意味著經歷無數戰役、累積戰功，並獲得城邦與神祇的認可。騎士肩負守護族群、維護秩序的使命，他們的存在不僅是武力的展現，更是榮耀與信仰的化身。<br><br>儘管諸神已然隱沒，不再如往昔那般直接干預凡間，但許多人相信，他們仍透過夢境、徵兆或神聖遺物，賜予騎士們非凡的意志與力量。<br><br>在馬茲提卡，主要有兩個騎士團：鷹騎士團 和 豹騎士團<br><br>鷹騎士<br>追隨羽蛇神夸爾特的理想。夸爾特象徵光明、公正與生命力，即使隱沒，他的榮光仍在鷹騎士的誓言中延續。他們身披金羽與鮮亮羽飾，行動果斷，視野高遠，常擔任前鋒與斥候。鷹騎士以守護與秩序為責，試圖在動盪的大陸中維持希望。<br><br>豹騎士<br>曾是邪神噬心者札爾特克的守護者。過去他們以「心臟獻祭」榮耀其神，但如今獻祭被禁止，這段歷史成為陰影。不得不尋求新的榮耀方式的他們，轉向以狩獵威脅這塊土地的蝰手獸或巨怪為榮。每一次成功的獵殺，都是他們取代舊祭典的新戰功。如今的榮耀，來自守護族群與斬殺危險，而非祭壇上的心臟。<br><br>選擇騎士範型，意味著承擔古老的榮光與沉重的責任。鷹騎士以光明之名守護秩序，豹騎士則以狩獵之道尋求新榮耀。`},
  {key:'薩滿',img:'images/profession/Shaman.png',text:`在馬茲提卡，大地與諸神的力量並未隨著神祇隱沒而完全消失。薩滿是最接近這股神秘力量的人，他們能觸碰凡人無法理解的能量，並以詩歌、祈禱、舞蹈或獻祭的方式引導魔法流動。薩滿的角色不僅是施術者，更是靈性導師、祭儀主持者與未知奧秘的研究者。<br><br>薩滿對於魔法的本質有不同解讀，因此形成了四種截然不同的流派：<br><br>靈魂流派：研究人類與萬物內在的精神能量──「托那利」。他們相信靈魂是力量的源泉，透過儀式可治癒、強化，甚至操縱他人精神。<br><br>獸術流派：蟲噬、獸爪與毒液的魔法，是邪神噬心者札爾特克賜予人類的黑暗贈禮。這些法術往往暴力而無情，模仿野獸的殘酷與掠食，但這些薩滿認為這是生存在殘酷大地上的必要力量。唯有藉由獸術，他們才能以野性的殘暴對抗荒野中的威脅，確保族群得以存續。<br><br>羽術流派：由大地母神馬茲提卡親自創造，並由其子夸爾特賜予人類，用以對抗札爾特克的大軍。羽術薩滿透過羽毛、光輝與聖歌施法，象徵純潔、保護與秩序。<br><br>元素流派：相信火、風、水、土是構成萬物的根本。他們透過操縱這四種元素來釋放力量，展現出大自然原始而無情的威能。<br><br>選擇薩滿範型，意味著你必須選擇一條流派之路，並決定自己對魔法本質的理解。是靈魂的力量、野性的殘暴、神聖的羽術，還是大自然的元素？在馬茲提卡的世界裡，薩滿的存在象徵著人類與神祇、自然與靈魂之間微妙的連結，而你的選擇，將決定你如何改變冒險的命運。`},
  {key:'學者',img:'images/profession/Scholar.png',text:`在馬茲提卡的城邦裡，學者代表著知識的傳承與探索。這片大地上的人類社會極為重視教育：兒童在十五歲之前由家長教育，學習基礎的倫理、勞作與信仰，並受公社監督。十五歲後，他們進入城邦學校，接受五年的進階教育。隨著不同族裔與人類的交流加深，學校裡也能看到半身人、矮人，甚至其他族群的學生，共同參與知識的學習。<br><br>在這些教育機構中，教師（Tlamatimine）是專責的講師，直到退休都屬於城邦的公共財產。但並非所有受過教育的人都會留在體制內。有些人選擇獨立研究，專注於天文、歷史、生物或數學的領域；也有人因失誤、爭議或挑戰傳統而被逐出教育體制。這些人，無論因何原因離開學校，通常都被稱為「學者」。<br><br>選擇學者範型，意味著你將以知識為武器。你可能是仰望星辰的占星師，或是保存傳說的記錄者，又或是深入叢林探究奇異生命的觀察者。雖然缺乏教師的穩固地位，卻能在冒險中成為隊伍的智囊，以知識與洞察力支援隊伍，解讀符號、推理線索、記錄歷史，用智慧與研究成果引導同伴走過險境。`},
  {key:'旅商',img:'images/profession/Pochteca.png',text:`在馬茲提卡廣袤的大地上，旅商不僅是貨物的搬運者，更是聯繫城邦與部族的關鍵人物。他們走遍叢林、山谷與河道，帶來玉石、黑曜石、可可豆、羽毛、香料與珍貴藥材，用以交換各地的特產。旅商讓資源得以流通，也讓偏遠村落得以接觸外界的繁榮。<br><br>然而，旅商的價值遠不止於貿易。當他們踏上漫長的旅程時，同時也承擔了情報傳遞的責任。城邦的統治者往往要求旅商在歸途中回報沿途所見，包括敵對勢力的動態、道路的狀況、部族間的爭執，甚至遺跡與怪物的傳聞。這些情報能決定一場戰爭的走向，或讓一座城邦提前準備防禦。<br><br>因而，旅商所傳遞的消息極其珍貴。若旅商在交易途中遭到殺害，不僅意味著貨物流通的中斷，更常被視為外交挑釁，足以成為戰爭爆發的導火線。他們的安危與地位，遠超出一般商人的想像。<br><br>選擇旅商範型，代表你將肩負財富與情報的雙重責任。你或許是一位能言善道的談判者，也可能是習慣長途旅行的生存家。無論如何，你的足跡與話語，將能改變馬茲提卡的命運。`},
  {key:'盜賊',img:'images/profession/Thief.png',text:`盜賊是行走於陰影與光明之間的人物。他們不如戰士般光榮，也不像詩人般受人讚頌，卻是城邦與荒野中不可或缺的角色。盜賊擅長鑽研陷阱、開鎖與潛行，他們的眼睛總能比別人更快找到隱藏的財寶與秘密。對許多人來說，盜賊雖帶著不光彩的名聲，但在探索古老遺跡、解決危險任務時，他們卻往往是最可靠的同伴。<br><br>馬茲提卡的叢林與遺跡中充滿陷阱與詭計，許多財寶不是被怪物守護，就是隱匿於古老機關之後。盜賊專精於拆解這些挑戰，能迅速判斷石板陷阱的壓力點，或發現牆壁中幾乎無痕的暗門。他們的雙手靈巧，不僅能竊取，也能修補與操作精密的機關。<br><br>在隊伍中，盜賊往往是「處理髒活」的人。他們能潛入敵營偷取情報，能悄然解決守衛，或是以狡詐與速度奪回珍貴的物品。他們懂得在黑市周旋，能將戰利品轉化為實際的資源。對盜賊而言，榮耀並非來自光明，而是來自於任務完成後，團隊仍能安全離開並滿載而歸。<br><br>選擇盜賊範型，代表你將探索危險的深處，扮演那個在陰影中行走、替隊伍解除危機的人。你或許是財寶的追尋者，也可能是不被光明接納的「解決者」──但無論如何，你的價值，總會在最關鍵的時刻顯現。`},
  {key:'農民',img:'images/profession/Farmer.png',text:`在馬茲提卡這塊大陸，農民並非單純耕作之人，而是最貼近大自然循環的守護者。他們掌握古老的浮田技術，能在湖泊與水道中建造人工小島，種植玉米、豆類、辣椒與番茄，同時利用水域的魚群與水草來滋養土壤。這種魚菜共生的方式，讓農民成為糧食與生態的維繫者，也是城邦與部族能繁榮存續的根基。<br><br>農民懂得如何從水域捕撈魚類，如何利用淤泥與水草肥沃土地，也知道哪些植物能作為食物，哪些則是祭品或藥材。他們在日常看似平凡，卻是社會中不可或缺的一環。沒有農民的智慧與辛勤，沒有任何城邦能長久屹立。<br><br>在冒險中，農民的價值同樣不可小覷。他們能辨認可食與有毒的植物，找到乾淨水源，或用簡單的工具捕獲魚類。他們對土地與水域的熟悉，使他們能帶領隊伍在叢林與濕地間尋找生機。<br><br>選擇農民範型，代表你將成為那個最踏實卻最堅韌的存在——用智慧與汗水，讓同伴在危險的旅程中不至於挨餓，並將自然的恩澤化為力量。`}
];

/* 劇本資料 */
const scenarios={
  prologue:[
    {key:'異光',img:'images/scenarios/01.png',text:`佩澤拉克近年來吸引許多不同族裔前往，無論是商業或工作機會都與日俱增。你們機緣巧合之下結伴同行，準備前往佩澤拉克，然而在危險的馬茲提卡大陸上，計畫永遠趕不上變化……<br><br>時長：約4–6小時<br>團務團務：1–2次<br>冒險人數：3–4人`},
    {key:'王墓之謎',img:'images/scenarios/02.png',text:`(接續異光)在科維小村短暫停留過後，接下來你們前往預定地下個停留地點－奧札爾特……<br><br>時長：約6–8小時<br>團務次數：3–4次<br>冒險人數：3–4人`}
  ],
  main:[
    {key:'失潮之夜',img:'images/scenarios/03.png',text:`「潮水未來，石像低語。舊神未醒，新災已起。」<br><br>佩澤拉克城，聚集了許多來自大陸上不同地方的族裔與居民，擁有豐富的資源，更重要的，這裡有著整個大陸獨一無二的設施－「冒險者公會」。你離開家鄉成為了一位冒險者，一路跋涉來到了佩澤拉克，準備在這個地方嶄露頭角，大顯身手…………<br><br>時長：約10–16小時<br>團務次數：4–6次　冒險人數：3–4人<br><small>備註：劇情較長，完整體驗至少需 4–6 次團務。</small>`},
  ],
  side:[
    {key:'無名之洞',img:'images/scenarios/04.png',text:`「請問你們有在這附近見到一位褐髮男子嗎?」<br>尋常的趕路行程，意外的訪客，焦急的妻子低聲啜泣。你們願意伸出援手嗎？<br><br>時長：約3–4小時<br>團務次數：One-shot<br>冒險人數：3–4人`},
    {key:'古樹之危',img:'images/scenarios/05.png',text:`「吱吱…吱吱吱!」<br>你低頭一看，一隻楚楚可憐的小動物正在你身邊磨蹭，雖然你聽不懂牠在說什麼，但你能感覺到牠的焦急和害怕。牠時不時望向森林的方向，難道是森林出了什麼大事嗎？<br><br>時長：約3–4小時<br>團務次數：One-shot<br>冒險人數：3–4人<br><small>備註：難度較高，建議至少跑完兩個前導劇本。</small>`}
  ]
};

/* ===== 渲染子分頁 ===== */
function renderSubTab(tab){
  // 僅支援族裔和職業範型兩個子分頁
  const map = tab==='race' ? raceList : classList;
  const first = map[0];
  return `
    <div class="sub-buttons">
      ${map.map((i,idx)=>`<button data-key="${i.key}" class="${idx===0?'active':''}">${i.key}</button>`).join('')}
    </div>
    <div class="sub-preview">
      <img id="sub-img" class="show" src="${first.img}" alt="${first.key}">
      <div class="desc" id="sub-desc">
        <h3 style="margin:0 0 8px">${first.key}</h3>
        <p class="show">${first.text}</p>
      </div>
    </div>
  `;
}

/* ===== 綁定互動 ===== */
function bindRegion(root){
  const img=root.querySelector('#region-img'); const desc=root.querySelector('#region-desc');
  const regionData={
    kutaka:{img:'images/regions/Kultaka.png',text:`庫塔卡，戰士的國度。儘管距離很近，但內克薩爾的大帝國從未完全征服過庫塔卡人，如果沒有庫塔卡軍隊，當年的黃金軍團永遠不可能擊敗內克薩爾。<br><br>這片土地本身就是一片肥沃的沿海平原，被一片廣闊的鹽沼與水域隔開，鹽沼裡棲息著蜥蜴人、蛙人和更糟糕的生物。<br><br>這個國家面臨的最大威脅仍然是內克薩爾，而沒有庫塔卡人，那些盤踞在此的蝰手獸們肯定會以更多的數量困擾馬茲提卡的其他地區。庫塔卡與這些生物永遠處於戰爭狀態，但他們繼續佔上風，歐克的血液在此平原上自由流淌。`},
    payit:{img:'images/regions/Payit.png',text:`帕伊特是一個偉大的國家，儘管歷史上外大陸的入侵幾乎使其失去了原有的地位，但經過如此摧殘後，重振旗鼓的帕伊特甚至比當年還要更加輝煌。如今，人們的民族自豪感非常強烈，最初的入侵者大多已經融入或消亡。<br><br>帕伊特憑藉其對羽術魔法的研究以及工匠創造的精美羽毛護身符，再次出色地帶領馬茲提卡走出了黑暗日子。這裡的學者眾多，是整個馬茲提卡大陸上科技與知識的發展重地。`},
    pezelac:{img:'images/regions/Pezelac.png',text:`佩澤拉克過去很難在一個被強大國家包圍和鄰近威脅的地方找到自己的定位。這個地區真正的當地居民很少，幾乎是周圍其他地區民族的聚集地，例如過去逃離家園廢墟的帕伊特人、庫塔卡人和內克薩爾人。<br><br>隨著近一個世紀貿易的成長，儘管土地本身貧瘠，但佩澤拉克的財富卻不斷增長。它的首都也稱為佩澤拉克，其城邦化程度和大陸重要性已足以與烏拉托斯和圖坎相提並論。馬茲提卡各地的商品幾乎都在這裡找的到。與瓦克利和科蘭一樣，旅商在這裡繁衍生息，甚至在市場上也能找到半身人和矮人。<br><br>佩澤拉克並不以其兇猛的戰士而聞名，但它靠近蝰手獸的地盤－內克薩爾，迫使它尋找有效的防禦力量。目前佩澤拉克向鄰國庫塔卡和帕伊特伸出援手，請求保護他們免受蝰手獸的侵害。為了換取利潤豐厚的貿易權，兩國都派遣了大量的戰士來回應，其中包括來自庫塔卡的豹騎士和來自帕伊特的鷹騎士。`},
    nexal:{img:'images/regions/Nexal.png',text:`曾經是整個馬茲提卡最偉大的帝國，但內克薩爾現在是怪物盤據的可怕領域。今天，細小的熔岩流從札塔爾山噴湧而出，但火山的黑暗斜坡提醒著人們一個多世紀前發生的災難，其影響至今仍然可見。<br><br>歐克現在是內克薩爾的優勢物種；他們殘忍而暴力，在上個世紀收割了數十萬被俘馬茲提卡人的心臟。儘管歐克不再是人類，但他們比任何其他現存族裔都更堅持馬茲提卡的古老生活方式，因為他們熱愛這種殘酷的做法。<br><br>這些蝰手獸不斷襲擊附近的國家，與庫塔卡的戰爭永無止境。`}
  };
  root.querySelectorAll('.region-buttons button').forEach(btn=>{
    btn.addEventListener('click',()=>{
      const k=btn.dataset.region, data=regionData[k]; if(!data) return;
      img.classList.remove('show'); desc.querySelectorAll('p').forEach(p=>p.classList.remove('show'));
      setTimeout(()=>{
        img.src=data.img; img.classList.add('show');
        desc.innerHTML=`<p>${data.text}</p>`;
        setTimeout(()=>{desc.querySelector('p').classList.add('show')},70);
      },260);
    });
  });
}
function bindPlayTabs(root){
  const tabBtns=root.querySelectorAll('.play-tabs button');
  const tabContent=root.querySelector('#play-tab-content');
  tabBtns.forEach(b=>b.addEventListener('click',()=>{
    tabBtns.forEach(x=>x.classList.remove('active')); b.classList.add('active');
    tabContent.innerHTML=renderSubTab(b.dataset.tab);
    bindSubButtons(tabContent,b.dataset.tab);
  }));
  bindSubButtons(tabContent,'race');
}
function bindSubButtons(root,tab){
  const img=root.querySelector('#sub-img'); const desc=root.querySelector('#sub-desc');
  const btns=root.querySelectorAll('.sub-buttons button');
  const map = tab==='race' ? raceList : classList;
  const dict=Object.fromEntries(map.map(i=>[i.key,i]));
  btns.forEach(btn=>{
    btn.addEventListener('click',()=>{
      btns.forEach(x=>x.classList.remove('active')); btn.classList.add('active');
      const it=dict[btn.dataset.key]; if(!it) return;
      img.classList.remove('show'); desc.querySelectorAll('p').forEach(p=>p.classList.remove('show'));
      setTimeout(()=>{
        img.src=it.img; img.classList.add('show');
        desc.innerHTML=`<h3 style="margin:0 0 8px">${it.key}</h3><p>${it.text}</p>`;
        setTimeout(()=>{desc.querySelector('p').classList.add('show')},70);
      },260);
    });
  });
}
function bindGuild(root){
  // 生成成員資料列表，可依需求填入實際資訊
  const toSlug = s => s.normalize('NFD').replace(/[^\w]/g,'');
  const names = ['帕庫塔','埃維爾','烏姆.帕蘇克','媞娜','奇烏科瓦','庫克','努巴夏','澤雷','伊茲跨烏膩','莫士','烏拉呱呱','約瓦利','托納爾','靜靜','瑪諾亞','伊文.狸影','夸烏特利','波塔．帕比','特拉納瓦特爾'];
const members = [
  {
    slug: '0',
    name: '帕庫塔',
    race: '(隊名未定)',
    class: '人類(綠民)/獸術薩滿',
    desc: '【無】',
    rank: 'E',
    portrait: '1.png',
    note: '玩家－霜月<br><br>目前已完成劇本：異光、王墓之謎、古樹之危、萬聖節限定-血影幽堡'
  },
  {
    slug: '1',
    name: '埃維爾',
    race: '(隊名未定)',
    class: '半身人/詩人',
    desc: '【無】',
    rank: 'Ｅ',
    portrait: '2.png',
    note: '玩家－Alviss<br><br>目前已完成劇本：異光、王墓之謎、古樹之危、萬聖節限定-血影幽堡'
  },
  {
    slug: '2',
    name: '烏姆.帕蘇克',
    race: '(隊名未定)',
    class: '人類(狗民)/學者(天律學)',
    desc: '【無】',
    rank: 'Ｅ',
    portrait: '3.png',
    note: '玩家－海洛<br><br>目前已完成劇本：異光、王墓之謎、古樹之危、萬聖節限定-血影幽堡'
  },
  {
    slug: '3',
    name: '媞娜.蒂拉',
    race: '(隊名未定)',
    class: '豹人(豹貓人)/戰士',
    desc: '【火辣椒征服者】',
    rank: 'Ｅ',
    portrait: '4.png',
    note: '玩家－若若<br><br>目前已完成劇本：異光、王墓之謎'
  },
  {
    slug: '4',
    name: '奇烏科瓦',
    race: '(隊名未定)',
    class: '人類(帕伊特人)/工匠(木匠)',
    desc: '【無】',
    rank: 'Ｅ',
    portrait: '5.png',
    note: '玩家－Wayne<br><br>目前已完成劇本：王墓之謎'
  },
  {
    slug: '5',
    name: '庫克',
    race: '(隊名未定)',
    class: '人類(狗民)/騎士',
    desc: '【庫塔卡豹騎士團】',
    rank: 'Ｅ',
    portrait: '6.png',
    note: '玩家－Noel<br><br>目前已完成劇本：異光、王墓之謎、無名之洞、失潮之夜'
  },
  {
    slug: '6',
    name: '努巴夏',
    race: '(隊名未定)',
    class: '豹人(狩豹人)/獵人',
    desc: '【無】',
    rank: 'Ｅ',
    portrait: '7.png',
    note: '玩家－墨白<br><br>目前已完成劇本：異光、王墓之謎、無名之洞、失潮之夜'
  },
  {
    slug: '7',
    name: '澤雷.寇特蘭',
    race: '(隊名未定)',
    class: '蛙人/旅商',
    desc: '【無】',
    rank: 'Ｅ',
    portrait: '8.png',
    note: '玩家－One<br><br>目前已完成劇本：異光、失潮之夜'
  },
  {
    slug: '8',
    name: '伊茲跨烏膩',
    race: '(隊名未定)',
    class: '矮人/騎士',
    desc: '【庫塔卡鷹騎士團】',
    rank: 'Ｅ',
    portrait: '9.png',
    note: '玩家－餃子<br><br>目前已完成劇本：異光、王墓之謎、無名之洞、萬聖節限定-血影幽堡'
  },
  {
    slug: '9',
    name: '莫士',
    race: '(隊名未定)',
    class: '精靈(木精靈)/靈魂薩滿',
    desc: '【無】',
    rank: 'Ｅ',
    portrait: '10.png',
    note: '玩家－阿海<br><br>目前已完成劇本：異光、王墓之謎、萬聖節限定-血影幽堡'
  },
  {
    slug: '10',
    name: '烏拉呱呱',
    race: '(隊名未定)',
    class: '蛙人/羽術薩滿',
    desc: '【無】',
    rank: 'Ｅ',
    portrait: '11.png',
    note: '玩家－Ping<br><br>目前已完成劇本：異光、王墓之謎、無名之洞、古樹之危、萬聖節限定-血影幽堡'
  },
  {
    slug: '11',
    name: '約瓦利',
    race: '(隊名未定)',
    class: '人類(庫塔卡人)/騎士',
    desc: '【庫塔卡鷹騎士團】',
    rank: 'Ｅ',
    portrait: '12.png',
    note: '玩家－水滴<br><br>目前已完成劇本：異光、王墓之謎、無名之洞、萬聖節限定-血影幽堡'
  },
  {
    slug: '12',
    name: '托納爾',
    race: '【夸爾特之羽】',
    class: '人類(庫塔卡人)/戰士',
    desc: '【庫塔卡飛魚】',
    rank: 'Ｅ',
    portrait: '13.png',
    note: '玩家－清雲<br><br>目前已完成劇本：異光、王墓之謎、無名之洞、古樹之危、萬聖節限定-血影幽堡'
  },
  {
    slug: '13',
    name: '靜靜',
    race: '【夸爾特之羽】',
    class: '豹人(狩豹人)/獵人',
    desc: '【無】',
    rank: 'Ｅ',
    portrait: '14.png',
    note: '玩家－ㄊㄊ<br><br>目前已完成劇本：異光、王墓之謎、無名之洞、古樹之危、萬聖節限定-血影幽堡'
  },
  {
    slug: '14',
    name: '瑪諾雅',
    race: '【夸爾特之羽】',
    class: '精靈(土精靈)/靈魂薩滿',
    desc: '【無】',
    rank: 'Ｅ',
    portrait: '15.png',
    note: '玩家－小熊<br><br>目前已完成劇本：異光、王墓之謎'
  },
    {
    slug: '15',
    name: '伊文·貍影',
    race: '(隊名未定)',
    class: '蜥蜴人/盜賊',
    desc: '【無】',
    rank: 'Ｅ',
    portrait: '16.webp',
    note: '玩家－外<br><br>目前已完成劇本：異光、王墓之謎'
  },
   {
    slug: '16',
    name: '夸烏特利‧月羽',
    race: '(隊名未定)',
    class: '鷹人/羽術薩滿',
    desc: '【無】',
    rank: 'Ｅ',
    portrait: '17.webp',
    note: '玩家－奧芬<br><br>目前已完成劇本：異光、王墓之謎'
  },
  {
    slug: '17',
    name: '波塔．帕比',
    race: '(隊名未定)',
    class: '豹人(豹貓人)/獵人',
    desc: '【無】',
    rank: 'Ｅ',
    portrait: '18.webp',
    note: '玩家－囧囧<br><br>目前已完成劇本：異光、王墓之謎'
  },
   {
    slug: '18',
    name: '特拉納瓦特爾',
    race: '(隊名未定)',
    class: '精靈(土精靈)/元素薩滿',
    desc: '【無】',
    rank: 'Ｅ',
    portrait: '19.webp',
    note: '玩家－霏飛<br><br>目前已完成劇本：(異光)、(王墓之謎)'
  },
   {
    slug: '19',
    name: '祖瑪',
    race: '【夸爾特之羽】',
    class: '人類(帕伊特人)/學者(生知學)',
    desc: '【無】',
    rank: 'Ｅ',
    portrait: '20.webp',
    note: '玩家－Gary<br><br>目前已完成劇本：異光、王墓之謎、萬聖節限定-血影幽堡'
  },
];
  const buttonsWrap = root.querySelector('#member-buttons');
  const cardArea = root.querySelector('#guild-card-area');
  const frontName = cardArea.querySelector('.front .name-field');
  const rankField = cardArea.querySelector('.back .rank-field');
  const back1 = cardArea.querySelector('.back .back-field1');
  const back2 = cardArea.querySelector('.back .back-field2');
  const back3 = cardArea.querySelector('.back .back-field3');
  // 備註顯示區，顯示會員的備註資訊；卡片上的欄位不會重複顯示
  const noteEl = root.querySelector('#guild-note');
  // 渲染成員按鈕，每個按鈕包含獨立的立繪，若找不到檔案則瀏覽器會回退為透明背景
  buttonsWrap.innerHTML = members.map((m,i)=>{
    // 使用成員對應的立繪檔名。若檔案不存在，CSS 會自動顯示背景顏色。
    const imgFile = m.portrait && m.portrait.trim() !== '' ? m.portrait : 'default.png';
    return `<button data-index="${i}" class="${i===0?'active':''}"><div class="avatar" style="background-image:url('images/portraits/${imgFile}')"></div><span>${m.name}</span></button>`;
  }).join('');
  // 顯示選定成員資訊
  const showMember = (m) => {
    // 更新正面姓名
    frontName.textContent = m.name;
    // 更新背面的等級英文字母
    rankField.textContent = m.rank;
    // 更新背面的三個欄位：族裔、範型、簡短描述
    back1.textContent = m.race ? `${m.race}` : '';
    back2.textContent = m.class ? `${m.class}` : '';
    // 提取描述的前 20 個字作為標籤，若無描述則留空
    const descSnippet = m.desc ? m.desc.slice(0,20) : '';
    back3.textContent = descSnippet;
    // 顯示備註區塊內容
    if(noteEl){
      noteEl.innerHTML = m.note ? `<p class="show">${m.note}</p>` : '';
    }
  };
  // 預設顯示第一位成員
  showMember(members[0]);
  // 綁定按鈕事件
  const btnEls = buttonsWrap.querySelectorAll('button');
  btnEls.forEach(btn=>{
    btn.addEventListener('click',()=>{
      btnEls.forEach(x=>x.classList.remove('active'));
      btn.classList.add('active');
      const idx = parseInt(btn.dataset.index,10);
      const member = members[idx];
      if(member) showMember(member);
    });
  });
}
function bindScenario(root){
  const catBtns=root.querySelectorAll('#scn-tabs button');
  const tagWrap=root.querySelector('#scn-tags');
  const detail=root.querySelector('#scn-detail'); const img=detail.querySelector('img'); const desc=detail.querySelector('.desc');
  const renderTags=(cat)=>{
    const list=scenarios[cat]||[];
    tagWrap.innerHTML=list.map((i,idx)=>`<button data-key="${i.key}" class="${idx===0?'active':''}">${i.key}</button>`).join('');
    const show=(item)=>{
      img.classList.remove('show'); desc.querySelectorAll('p').forEach(p=>p.classList.remove('show'));
      setTimeout(()=>{
        img.src=item.img; img.classList.add('show');
        desc.innerHTML=`<h3 style="margin:0 0 8px">${item.key}</h3><p>${item.text}</p>`;
        setTimeout(()=>{desc.querySelector('p').classList.add('show')},60);
      },260);
    };
    if(list[0]) show(list[0]);
    tagWrap.querySelectorAll('button').forEach(b=>{
      b.addEventListener('click',()=>{
        tagWrap.querySelectorAll('button').forEach(x=>x.classList.remove('active')); b.classList.add('active');
        const it=list.find(x=>x.key===b.dataset.key); if(it) show(it);
      });
    });
  };
  catBtns.forEach(b=>b.addEventListener('click',()=>{catBtns.forEach(x=>x.classList.remove('active')); b.classList.add('active'); renderTags(b.dataset.scncat)}));
  renderTags('prologue');
}

/* 渲染入口 */
function render(section){
  const stage=document.getElementById('stage');
  stage.innerHTML=Templates[section]?Templates[section]():Templates.dragonbane();
  applyStagger(stage);
  setupSlideshow(stage);
  if(section==='maztica') bindRegion(stage);
  if(section==='play')    bindPlayTabs(stage);
  if(section==='guild')   bindGuild(stage);
  if(section==='scenario')bindScenario(stage);
}

/* 主選單切換 */
document.querySelectorAll('.menu button').forEach(btn=>{
  btn.addEventListener('click',()=>{
    document.querySelectorAll('.menu button').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    render(btn.dataset.section);
  });
});

/* 初始載入 */
render('dragonbane');

/* ===== BGM 控制邏輯 ===== */
(()=>{
  const bgm = document.getElementById('bgm');
  const toggle = document.getElementById('bgm-toggle');
  const vol = document.getElementById('bgm-volume');
  const sourceInput = document.getElementById('bgm-source');
  if(bgm){
    // 初始化音量與音源
    bgm.volume = parseFloat(vol.value);
    // 設定初始音源為輸入欄位的值
    if(sourceInput && sourceInput.value){
      bgm.src = sourceInput.value.trim();
    }
    // 播放/暫停
    toggle.addEventListener('click',()=>{
      if(bgm.paused){
        bgm.play().catch(()=>{});
        toggle.textContent = '⏸';
      }else{
        bgm.pause();
        toggle.textContent = '▶';
      }
    });
    // 調節音量
    vol.addEventListener('input',()=>{
      bgm.volume = parseFloat(vol.value);
    });
    // 更換音樂檔路徑
    if(sourceInput){
      sourceInput.addEventListener('change',()=>{
        const path = sourceInput.value.trim();
        if(path){
          const wasPlaying = !bgm.paused;
          bgm.pause();
          bgm.src = path;
          if(wasPlaying){
            bgm.play().catch(()=>{});
          }
        }
      });
    }
  }
})();
</script>
</body>
</html>
